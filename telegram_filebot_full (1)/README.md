# Telegram FileBot

ุฑุจุงุช ุจุฑุง ูุฏุฑุช ู ุจู ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ ูุงูโูุง ุฏุฑ ุชูฺฏุฑุงู ุจู ููุฑุงู ฺฉ ุจฺฉโุงูุฏ ููุดุชูโุดุฏู ุจุง FastAPI.

## ๐พ ูุตุจ ู ุงุฌุฑุง ูพุฑูฺู

### ูพุดโูุงุฒูุง
1. **ูุตุจ Git**
   ```bash
   sudo apt update
   sudo apt install git -y
   ```
2. **ูุตุจ Docker ู Docker Compose**
   ```bash
   sudo apt install docker.io docker-compose-v2 -y
   sudo systemctl enable --now docker
   ```
3. ุจุฑุง ุงุฌุฑุง ูุญู ูุงุฒ ุงุณุช Python 3.11 ูุตุจ ุดุฏู ุจุงุดุฏ.

### ุฑุงูโุงูุฏุงุฒ ุฎูุฏฺฉุงุฑ
ุงุณฺฉุฑูพุช `setup.sh` ุชูุงู ูพุดโูุงุฒูุง ุฑุง ูุตุจ ฺฉุฑุฏู ู ุณุฑูุณโูุง ุฑุง ุงุฌุฑุง ูโฺฉูุฏ. ูพุณ ุงุฒ ฺฉููู ูุฎุฒู ฺฉุงู ุงุณุช ุฏุณุชูุฑ ุฒุฑ ุฑุง ุงุฌุฑุง ฺฉูุฏ:
```bash
sudo bash setup.sh
```
ุฏุฑ ููฺฏุงู ุงุฌุฑุง ููุงุฏุฑ ููุฑุฏ ูุงุฒ ูุงููุฏ ุชูฺฉู ุฑุจุงุช ู ุฏุงููู ุฏุงูููุฏ ุงุฒ ุดูุง ูพุฑุณุฏู ูโุดูุฏ ู ูพุณ ุงุฒ ุงุชูุงูุ ุฑุจุงุช ู ูุจโุณุฑูุณ ูุนุงู ุฎูุงููุฏ ุดุฏ.

### ุฑุงูโุงูุฏุงุฒ ุณุฑุน ุจุง Docker
1. ุงุจุชุฏุง ูุฎุฒู ุฑุง ฺฉููู ฺฉูุฏ:
   ```bash
   git clone <ุขุฏุฑุณ-ูุฎุฒู>
   cd telegram_filebot_full
   ```
2. ูุงู `.env` ุฏุฑ ุฑุดู ูพุฑูฺู ุจุณุงุฒุฏ ู ููุงุฏุฑ ุฒุฑ ุฑุง ูุงุฑุฏ ฺฉูุฏ ุง ุงุฒ ุงุณฺฉุฑูพุช `setup.sh` ุงุณุชูุงุฏู ฺฉูุฏ:
   ```env
   BOT_TOKEN=<ุชูฺฉู ุฑุจุงุช ุชูฺฏุฑุงู>
   # ุขุฏุฑุณ ุณุฑูุณ ุจฺฉโุงูุฏ. ุฏุฑ ูุญุท Docker ุจู ุตูุฑุช ูพุดโูุฑุถ ฺฉุงูุชูุฑ `bot`
   # ุงุฒ ุทุฑู ูุงู ุณุฑูุณ `backend` ุจู ูุจโุณุฑูุณ ุฏุณุชุฑุณ ุฏุงุฑุฏ.
   API_BASE_URL=http://backend:8000
   DOWNLOAD_DOMAIN=<ุฏุงููู ุง IP ุณุฑูุฑ>
   ADMIN_IDS=<ุดูุงุณู ุนุฏุฏ ุงุฏููโูุง ุจุง ฺฉุงูุง>
  ADMIN_API_TOKEN=<ุชูฺฉู ูุฎุตูุต ุงุฏูู>
   SUBSCRIPTION_REMINDER_DAYS=3
   REQUIRED_CHANNEL=<ุขุฏ ุนุฏุฏ ุง ูุฒุฑูู ฺฉุงูุงู ุงูุฒุงู>
   API_ID=<api id>
   API_HASH=<api hash>
   ```
   ููุฏุงุฑ `DOWNLOAD_DOMAIN` ุจุงุฏ ุจู ุฏุงูููโุง ฺฉู Nginx ุฑู ุขู ุณุฑูุณ ูโุฏูุฏ ุงุดุงุฑู ฺฉูุฏ.
3. ุฏุฑ ุตูุฑุช ูุงุฒ ูุงู `app/settings.json` ุฑุง ูุฒ ูุฑุงุด ฺฉูุฏ.
4. ุงุฌุฑุง ุณุฑูุณโูุง:
   ```bash
   docker compose up --build -d
   ```
5. ุจุฑุง ูุดุงูุฏู ูุงฺฏโูุง:
   ```bash
   docker compose logs -f
   ```
   ุจุนุฏ ุงุฒ ุจุงูุง ุขูุฏู ฺฉุงูุชูุฑูุงุ ุฑุจุงุช ุขูุงุฏู ุงุณุชูุงุฏู ุงุณุช.

### ุงุฌุฑุง ูุญู
```bash
pip install -r requirements.txt
uvicorn app.main:app --reload
python app/bot.py
```

ูุชุบุฑูุง ูุญุท ููู:
- `BOT_TOKEN`: ุชูฺฉู ุฑุจุงุช ุชูฺฏุฑุงู
- `API_BASE_URL`: ุขุฏุฑุณ API ุจฺฉโุงูุฏ ุจุฑุง ุฑุจุงุช
  ุฏุฑ ุญุงูุช ุงุณุชูุงุฏู ุงุฒ Docker Compose ููุฏุงุฑ ูพุดููุงุฏ `http://backend:8000` ุงุณุช.
- `DOWNLOAD_DOMAIN`: ุฏุงูููโุง ฺฉู ุจู ฺฉุงุฑุจุฑ ุจุฑุง ุฏุงูููุฏ ูุดุงู ุฏุงุฏู ูโุดูุฏ
- `SUBSCRIPTION_REMINDER_DAYS`: ุชุนุฏุงุฏ ุฑูุฒูุง ูุงูุฏู ุจู ุงููุถุง ุงุดุชุฑุงฺฉ ฺฉู ุงุฏุขูุฑ ุงุฑุณุงู ูโุดูุฏ
- `REQUIRED_CHANNEL`: ุดูุงุณู ุง ูุฒุฑูู ฺฉุงูุงู ฺฉู ุนุถูุช ุฏุฑ ุขู ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุฑุจุงุช ุงูุฒุงู ุงุณุช
- `API_ID` ู `API_HASH`: ููุงุฏุฑ ูุงุฒู ุจุฑุง ุงุณุชูุงุฏู ุงุฒ API ุชูฺฏุฑุงู
ููุฏุงุฑ `DOWNLOAD_DOMAIN` ุจุงุฏ ุจู ุฏุงูููโุง ฺฉู Nginx ุฑู ุขู ุฏุฑ ุญุงู ุณุฑูุณโุฏู ุงุณุช ุงุดุงุฑู ฺฉูุฏ.

## ๐ ุงุญุฑุงุฒ ููุช ุงุฏูู
ููู routeูุง `/admin/` ูุงุฒููุฏ ูุฏุฑ ุงุญุฑุงุฒ ููุช Bearer ูุณุชูุฏ:
```
Authorization: Bearer <ุชูฺฉู ุงุฏูู>
```

## ๐ฆ ุณุงุฎุชุงุฑ
- `app/main.py`: ุงุฌุฑุง FastAPI
- `app/bot.py`: ุงุฌุฑุง ุฑุจุงุช ุชูฺฏุฑุงู
- `app/services/cleanup.py`: ูพุงฺฉโุณุงุฒ ูุงูโูุง ูููุถ
- `app/services/subscription_reminder.py`: ุงุฑุณุงู ุงุฏุขูุฑ ุงุชูุงู ุงุดุชุฑุงฺฉ
  (ูุงุจู ุงุฌุฑุง ุจู ุตูุฑุช ุฏูุฑูโุง ุจุฑุง ุงุทูุงุนโุฑุณุงู ุจู ฺฉุงุฑุจุฑุงู)

## ๐ ุงูุฏูพููุชโูุง ุฌุฏุฏ
- `POST /file/upload` ุจุงุฑฺฏุฐุงุฑ ูุชุงุฏุชุง ูุงู. ูุงุฒููุฏ ูุฏุฑ `X-User-Id`.
- `POST /file/upload_link` ุฏุงูููุฏ ูุงู ุงุฒ ููฺฉ ู ุซุจุช ุขู.
- `GET /file/list` ุฏุฑุงูุช ูุณุช ูุงูโูุง ฺฉุงุฑุจุฑ.
- `DELETE /file/delete/{file_id}` ุญุฐู ูุงู ูุชุนูู ุจู ฺฉุงุฑุจุฑ.
- `POST /file/regenerate/{file_id}` ุชููุฏ ููฺฉ ุฏุงูููุฏ ุฌุฏุฏ ุจุฑุง ูุงู.
- `POST /admin/user/block/{user_id}` ูุณุฏูุฏ ฺฉุฑุฏู ฺฉุงุฑุจุฑ
- `POST /admin/user/unblock/{user_id}` ุฑูุน ูุณุฏูุฏ ฺฉุงุฑุจุฑ
- `GET /admin/users` ููุฑุณุช ฺฉุงุฑุจุฑุงู ุจุง ุงูฺฉุงู ุฌุณุชุฌู
- `GET /admin/files` ููุฑุณุช ูุงูโูุง ุจุง ุงูฺฉุงู ุฌุณุชุฌู

## ๐ค ุฏุณุชูุฑุงุช ุฑุจุงุช
- `/files` ููุงุด ูุณุช ูุงูโูุง ุดูุง
- `/delete <file_id>` ุญุฐู ูุงู ุจุง ุดูุงุณู ุฏุงุฏู ุดุฏู
- `/uploadlink <URL>` ุฏุงูููุฏ ูุงู ุงุฒ ููฺฉ
- `/mysub` ููุงุด ุงุทูุงุนุงุช ุงุดุชุฑุงฺฉ ุดูุง
- `/myid` ุฏุฑุงูุช ุขุฏ ุนุฏุฏ ุดูุง
- `/pausebot` ุชููู ูููุช ุฑุจุงุช (ุงุฏูู)
- `/resumebot` ุงุฏุงูู ฺฉุงุฑ ุฑุจุงุช (ุงุฏูู)
- `/broadcast <msg>` ุงุฑุณุงู ูพุงู ููฺฏุงู (ุงุฏูู)
- `/cancelall` ูุบู ุชูุงู ูพุฑุฏุงุฒุดโูุง (ุงุฏูู)
- `/admin` ููุงุด ูพูู ูุฏุฑุช ุจุง ุฏฺฉููโูุง ุดุดูโุง (ุงุฏูู)
ููฺูู ุจุง ุฏฺฉููโูุง ุดุดูโุง ูโุชูุงูุฏ ููฺฉ ุฌุฏุฏ ุจุณุงุฒุฏ ุง ูุงู ุฑุง ุญุฐู ฺฉูุฏ.

## ๐ฅ๏ธ ูพูู ูุจ ุงุฏูู
ุขุฏุฑุณ `/admin/panel` ุตูุญูโุง ุจุฑุง ูุดุงูุฏู ูุญุธูโุง ูุตุฑู ููุงุจุน ุณุฑูุฑ ู ูุฑุงุด ุชูุธูุงุช ููุฌูุฏ ุฏุฑ `settings.json` ุงุณุช.

## ๐งช ุชุณุชโูุง
ุจู ุฒูุฏ ุงุถุงูู ูโุดูุฏ...
